# What you can find in this repository?

This repository contains data and codes used in the analyses of the article entitled *"Intrahost speciations and host switches shaped the evolution of herpesviruses
"*.


## Building a host tree using TimeTree data

If one uses the file `list_host.txt` as input on [timetree.org](https://timetree.org/), a large host tree can be downloaded. That tree can be narrowed down to include only taxa found in the original list by running the script `timetree.py`, which will prune the tree downloaded from timetree.org.

```
python timetree.py --timetree ./examples_input/host_timetree.tree --list ./examples_input/list_hosts.txt --clades clades.tsv --output pruned_tree.tree
```

Check the directory `examples_output` to see the expected outputs. The file `clades.tsv` lists all members of each clade in `pruned_tree.tree`.

## Adding divergence time intervals as tree traits

To add divergence time intervals as traits in the `pruned_tree.tree`, one needs to edit the file `clades.tsv` generated by `timetree.py`. Such file must resembles the file `examples_input/clades_tmrcas.tsv`, which includes confidence intervals of divergence times provided by [timetree.org](https://timetree.org/). Once that is done, one can run the script `add_traits.py`:

```
add_traits.py --timetree pruned_tree.tree --tmrcas clades_tmrcas.tsv --output host_treetime.tree
```

Check the directory `examples_output` to see the expected outputs.


### Dependencies

For running `timetree.py`, the following Python 3 packages must be installed:


* biopython
* argparse
* pandas
* [baltic](https://github.com/evogytis/baltic)


## Author

* **Anderson Brito** - [WebPage](https://andersonbrito.github.io/) - andersonfbrito@gmail.com

## License

This project is licensed under the MIT License.

<!---
--->