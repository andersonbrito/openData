# What you can find in this repository?

This repository contains data and codes used in the analyses of the article entitled *"Intrahost speciations and host switches shaped the evolution of herpesviruses
"*.


## Converting nexus files into Jane dated trees

To run [Jane](https://www.cs.hmc.edu/~hadas/jane/index.html#get), time-resolved trees on beast format need to be converted into Jane format. To do so, one can run the python script `nexus2jane.py`:d


```
python nexus2jane.py --virus-tree ./examples_input/virus_beast_mcc.tree --host-tree ./examples_input/host_treetime.tree --pairs ./examples_input/vhPairs_alpha.tsv --window 5
```

The file `host_treetime.tree` is the one generated by `timetree.py` and `add_traits.py`. The argument `5` will split the input trees in time zones of 5 Million years. Set it up as desired.

## Parsing Jane outputs

To parse the output files produced under each cost regime, one can run the script `parse_jane_files.py`. In this example, the files that will be processed can be found in `example_input` (files named `results_CR##`).

```
python parse_jane_files.py --directory example_input
```

Check the directory `examples_output` to see the expected outputs.

### Dependencies

For running `parse_jane_files.py`, the following Python 3 packages must be installed:


* pandas
* argparse


## Author

* **Anderson Brito** - [WebPage](https://andersonbrito.github.io/) - andersonfbrito@gmail.com

## License

This project is licensed under the MIT License.

<!---
--->