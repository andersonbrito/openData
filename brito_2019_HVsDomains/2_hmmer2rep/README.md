# Searching for domains

`hmmer2rep.py` performs the second step of the analysis pipeline. It searches for domain hits on HMMER (`hmmscan`) outputs (domtblout), and convert it into a custom format used in the next step of the pipeline. Each file this code outputs contains information about the repertoire of protein domains encoded by each genome.

## Running hmmscan

Before running `hmmer2rep.py`, the user must run `hmmscan` using the output sequences generated by `tORFs.py`. `hmmscan` is a software available as part of `HMMER`, which can be downloaded [here](http://hmmer.org/download.html). `hmmscan` scans for protein domains using aminoacid sequences using a protein profile HMM database, a large file required for running `hmmscan`. The most up to date HMM profile (Pfam-A.hmm) can be found at the [Pfam webiste](http://bit.ly/2BUXaWV). To run `hmmscan`, a command line similar to the one below can be used:

```
hmmscan --domtblout domtblout.txt --acc --cut_ga /path/to/hmm/file/Pfam-A.hmm ./sequences.fasta
```

where `sequences.fasta` is a concatenated file including all the entries generated by `tORFs.py`. Once `hmmscan` finishes running (it may take a long time), it will output as a text file (`domtblout.txt`) all domains found while scanning `sequences.fasta`, file which will be finally used for running `hmmer2rep.py`.

## Running hmmer2rep.py

### Dependencies

For running `hmmer2rep.py`, the following Python3 packages must be installed:

* Biopython
* BeautifulSoup

### Execution

`hmmer2rep.py` can be executed using a command similar to:

```
python hmmer2rep.py -input domtblout.txt -list accnos.txt -output dom_repertoire.tsv
```
where the `accnos.txt` is the same tab-delimited file with accession numbers and taxa names used for running `tORFs.py`. `hmmer2rep.py` will filter out unreliable hits in `domtblout.txt`, exporting only those showing E-values ('protein E-values') and c-Evalues ('domain E-values') smaller than or equal to 1e-03. See the `examples` directory for more details about input and output files.

## Running domAnnot.py

`domAnnot.py` is an annotation tool that takes as inputs the outputs of `tORFs.py` and `hmmscan` (domtblout.txt), and generates GFF files highlighting the regions that potentially encode the detected domains.

### Dependencies

For running `domAnnot.py`, the following Python3 packages must be installed:

* Biopython

### Execution

`domAnnot.py` can be executed using a command similar to:

```
python domAnnot.py fastaFile domtblout.txt
```

where the `fastaFile` is one of the peptide multifasta files generated by `tORFs.py`, which display in each sequence header the genomic location where the translated ORFs are found. The output GFF file can be opened in genomics sofware like [Artemis](https://www.sanger.ac.uk/science/tools/artemis) alongside GB files with the existing genome annotation of the reference genomes (eg. [NC_001806](https://www.ncbi.nlm.nih.gov/nuccore/NC_001806))

## Authors

* **Anderson Brito** - [WebPage](https://andersonbrito.github.io/) - andersonfbrito@gmail.com

## License

This project is licensed under the MIT License.

<!---
--->
