# Reconstructing character evolution

This step of the pipeline uses the output of [Mesquite](https://www.mesquiteproject.org/) to reconstruct character (domain) evolution along a given phylogeny, using `charEvol.py`. In the context of domains evolution, the character states are defined by a matrix of protein domain counts per genome, generated in the previous step by `domMatrix.py`. Based on such matrix, Mesquite can estimate events of character gains, losses and duplications along a tree using a Parsimony model. This model reconstructs the ancestral states (number of domains) at the internal nodes of trees, while minimising the number of changes (events) given the species phylogeny and the matrix (domain distribution).


### Running Mesquite

First, download and install [Mesquite](https://www.mesquiteproject.org/Installation.html). For reconstructing the number of domains encoded by ancestral genomes, Mesquite requires as inputs: (1) a matrix of domain counts, and; (2) a species tree (Newick format), with taxa named as they appear in the matrix. To run the software, combine matrix and tree into Mesquite following the steps below:

1. Copy the whole matrix generated by `domMatrix.py` in text format;
2. Open the target beast tree on Mesquite (File > Open File);
3. Go to Menu 'Characters' > Make new matrix from > Clipboard > Select 'Meristic' as the data category. Also, to ensure the correct formatting of the matrix, below 'Data type', select 'Includes character names' and 'Includes taxon names'. Click 'Ok', give the matrix a name, and you will be prompted the final matrix.

Now, the tree and the matrix are associated in the same 'Mesquite Project', allowing you to run the ['Character history' analysis](http://mesquiteproject.org/mesquiteArchives/mesquite2.75/Mesquite_Folder/docs/mesquite/CharacterEvolution/AncestralStates.html). To do so:

4. Select the tab containing the tree, and access the menu 'Analysis:Tree' > 'Trace all characters'. Select 'Parsimony Ancestral state' as the reconstruction method;
5. Make sure the terminal nodes (tips of the tree) are represented in the matrix: access the menu 'Trace_All', and select 'Show Terminal Nodes';
5. Select the tab containing the new matrix content ('Trace All Characters'), and save it as a text file at 'File' > 'Save Window as Text'.

## Running charEvol.py

After running Mesquite, 

```
Give examples
```

## Authors

* **Anderson Brito** - [WebPage](https://andersonbrito.github.io/) - andersonfbrito@gmail.com

## License

This project is licensed under the MIT License.

